spring:
  application:
    name: resto-hub-admin-api
  autoconfigure:
    exclude:
      - org.springframework.boot.actuate.autoconfigure.tracing.zipkin.ZipkinAutoConfiguration
  
  datasource:
    url: ${DB_URL:jdbc:postgresql://localhost:5432/restohub}
    username: ${DB_USER:restohub}
    password: ${DB_PASSWORD:restohub}
    driver-class-name: org.postgresql.Driver
  
  jpa:
    hibernate:
      ddl-auto: none
    show-sql: ${SHOW_SQL:false}
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
  
  liquibase:
    enabled: true
    change-log: classpath:liquibase/changelog/db.changelog-master.xml
  
  mail:
    host: ${MAIL_HOST:smtp.gmail.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME:}
    password: ${MAIL_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
    from: ${MAIL_FROM:no-reply@restohub.com}
  
  servlet:
    multipart:
      # ВАЖНО: Эти значения должны совпадать с client_max_body_size в nginx/nginx.conf.template
      # для location /admin-api (по умолчанию nginx имеет лимит 1MB, что вызывает ошибку 413)
      max-file-size: 10MB
      max-request-size: 10MB

server:
  port: ${SERVER_PORT:8082}
  servlet:
    context-path: /admin-api

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when-authorized
      probes:
        enabled: true
  health:
    mail:
      enabled: false
  tracing:
    sampling:
      probability: 1.0
    # Zipkin отключен через spring.autoconfigure.exclude

logging:
  level:
    root: INFO
    com.restohub: DEBUG
    org.zalando.logbook: TRACE
  pattern:
    level: "%5p [${spring.application.name:},%X{traceId:-},%X{spanId:-}]"

logbook:
  filter:
    enabled: true
  format:
    style: json
  predicate:
    exclude:
      - path: /actuator/**
  obfuscate:
    headers:
      - Authorization
      - X-API-Key

jwt:
  secret: ${JWT_SECRET:your-256-bit-secret-key-here-must-be-at-least-256-bits-long-for-security}
  access-token-expiration: ${JWT_ACCESS_TOKEN_EXPIRATION:300}
  refresh-token-expiration: ${JWT_REFRESH_TOKEN_EXPIRATION:3600}

cors:
  allowed-origin: ${ADMIN_WEB_URL:http://localhost:3001}
  client-web-url: ${CLIENT_WEB_URL:http://localhost:3000}

company:
  name: ${COMPANY_NAME:RestoHub}
  bin: ${COMPANY_BIN:}
  address: ${COMPANY_ADDRESS:}
  bank: ${COMPANY_BANK:}
  bik: ${COMPANY_BIK:}
  iik: ${COMPANY_IIK:}
  kbe: ${COMPANY_KBE:}

api:
  1c:
    key: ${API_1C_KEY:change-me-in-production}

resend:
  from: ${RESEND_FROM:no-reply@restohub.kz}

whatsapp:
  api:
    provider: ${WHATSAPP_PROVIDER:meta}  # meta, green-api, twilio
    # Meta WhatsApp Business API настройки
    app-id: ${WHATSAPP_APP_ID:}  # App ID из Meta for Developers
    app-secret: ${WHATSAPP_APP_SECRET:}  # App Secret из Meta for Developers
    access-token: ${WHATSAPP_ACCESS_TOKEN:}  # Access Token (долгоживущий)
    phone-number-id: ${WHATSAPP_PHONE_NUMBER_ID:}  # Phone Number ID
    business-account-id: ${WHATSAPP_BUSINESS_ACCOUNT_ID:}  # WhatsApp Business Account ID
    webhook-verify-token: ${WHATSAPP_WEBHOOK_VERIFY_TOKEN:}  # Токен для верификации webhook
    webhook-url: ${WHATSAPP_WEBHOOK_URL:http://localhost:8082/admin-api/whatsapp/webhook}
    bot-phone: ${WHATSAPP_BOT_PHONE:79991234567}  # Номер телефона бота (для ссылок)
    base-url: ${WHATSAPP_API_BASE_URL:https://graph.facebook.com/v18.0}  # Graph API URL
    # Обратная совместимость (для других провайдеров)
    api-key: ${WHATSAPP_API_KEY:}  # Для green-api, twilio
    api-secret: ${WHATSAPP_API_SECRET:}  # Для green-api, twilio

