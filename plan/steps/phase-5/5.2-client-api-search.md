# Шаг 5.2: Поиск и фильтрация

## Описание
Реализация поиска ресторанов по различным критериям: название, блюда из меню, акции, тематические вечера, геолокация.

## Задачи

### 1. API поиска ресторанов
- **GET** `/client-api/r/search`
- Query параметры:
  - `q` - поисковый запрос (название ресторана)
  - `menu_item` - поиск по названию блюда (menu_item)
  - `promotion` - поиск по промо-событиям (акции, тематические вечера, новинки)
  - `promotion_type` - фильтр по типу промо-события (опционально)
  - `lat` - широта для поиска по карте
  - `lng` - долгота для поиска по карте
  - `radius` - радиус поиска в км (для геолокации)
  - `limit` - количество результатов
  - `offset` - пагинация

### 2. Поиск по названию ресторана
- Full-text search по названию
- Case-insensitive поиск
- Частичное совпадение (LIKE или полнотекстовый поиск PostgreSQL)
- Сортировка по релевантности

### 3. Поиск по блюдам из меню
- Поиск ресторанов, которые имеют блюдо с указанным названием
- Full-text search по названию блюда
- Возвращает ресторан и информацию о найденном блюде
- Поддержка поиска по описанию блюда (опционально)

### 4. Поиск по промо-событиям (promotions)
- Поиск ресторанов с активными промо-событиями (акции, тематические вечера, новинки)
- Фильтрация по названию промо-события
- Фильтрация по типу промо-события (через promotion_type)
- Возвращает ресторан и информацию о промо-событии
- Только активные промо-события (по датам)
- Поддержка разных типов: акции, тематические вечера, новинки

### 5. Поиск по карте (геолокация)
- Расчет расстояния от точки до ресторана (Haversine formula)
- Фильтрация ресторанов в указанном радиусе
- Сортировка по расстоянию
- Возврат расстояния в результатах

### 6. Комбинированный поиск
- Возможность комбинации нескольких фильтров
- Логика AND для комбинации фильтров
- Приоритет результатов

### 7. Оптимизация поиска
- Индексы в БД для полей поиска
- Полнотекстовый поиск PostgreSQL (опционально)
- Кеширование популярных запросов (опционально)

### 8. Формат ответа
- Единый формат ответа для всех типов поиска
- Информация о типе совпадения (название, блюдо, промо-событие и т.д.)
- Метаданные (общее количество результатов, страницы)

