# Шаг 5.1: Публичные данные ресторанов

## Описание
Реализация публичного API для получения данных о ресторанах, меню и карте столов для client-web.

## Задачи

### 1. API для получения списка ресторанов
- **GET** `/client-api/r`
- Query параметры:
  - `limit` - количество результатов
  - `offset` - пагинация
  - `status` - фильтр по статусу (только активные)
- Возвращает:
  - Список ресторанов с базовой информацией
  - Только рестораны с активной подпиской
- Поля в ответе:
  - id
  - название
  - адрес
  - телефон
  - геолокация
  - логотип
  - краткое описание

### 2. API для получения информации о ресторане
- **GET** `/client-api/r/:id`
- Возвращает полную информацию о ресторане:
  - Все поля ресторана
  - Настройки дизайна (лого, фон, цвета)
  - Контактная информация
  - WhatsApp номер
- Проверка активной подписки

### 3. API для получения меню
- **GET** `/client-api/r/:id/menu`
- Возвращает:
  - Категории блюд с порядком
  - Блюда в каждой категории с полной информацией:
    - Название, описание, цена
    - Фотографии
    - Состав, вес/объем (если есть)
  - Только доступные блюда (status = available)
- Проверка активной подписки ресторана

### 4. API для получения списка этажей
- **GET** `/client-api/r/:id/floor`
- Возвращает:
  - Список этажей ресторана
  - Только активные этажи
- Поля в ответе:
  - id
  - floorNumber (номер этажа, например "1", "Крыша", "Подвал")
- Проверка активной подписки

### 5. API для получения списка залов
- **GET** `/client-api/r/:id/room`
- Query параметры:
  - `floorId` - фильтр по этажу (опционально)
- Возвращает:
  - Список залов ресторана
  - Только активные залы
- Поля в ответе:
  - id
  - name (название зала)
  - floorId (ID этажа)
  - isSmoking (курение разрешено)
  - isOutdoor (зал на открытом воздухе)
- Проверка активной подписки

### 6. API для получения информации о зале
- **GET** `/client-api/r/:id/room/:roomId`
- Возвращает:
  - Полную информацию о зале
  - План помещения (imageId)
- Поля в ответе:
  - id
  - name
  - description
  - floorId
  - isSmoking
  - isOutdoor
  - imageId (план помещения)
- Проверка активной подписки

### 7. API для получения списка столов зала
- **GET** `/client-api/r/:id/table`
- Query параметры:
  - `roomId` - фильтр по залу (required для выбора столов)
  - `floorId` - фильтр по этажу (опционально)
- Возвращает:
  - Список столов зала
  - Только активные столы
- Поля в ответе:
  - id
  - tableNumber (номер стола)
  - roomId (ID зала)
  - capacity (количество мест)
  - description (описание стола, опционально)
  - imageId (фото стола)
  - depositAmount (депозит, если указан)
  - depositNote (примечание о депозите)
- Проверка активной подписки

### 8. API для получения карты столов (иерархическая структура)
- **GET** `/client-api/r/:id/table/map`
- Query параметры:
  - `floorId` - фильтр по этажу (опционально)
  - `roomId` - фильтр по помещению (опционально)
- Возвращает:
  - Иерархическую структуру этажей → залов → столов
  - Планы помещений
  - Номера столов (`tableNumber`) для сопоставления с визуальной схемой
- Проверка активной подписки
- **Примечание**: Координаты столов не хранятся в БД. Номера столов на схеме соответствуют `tableNumber` в БД

### 9. Оптимизация
- Кеширование публичных данных (опционально)
- Оптимизация запросов (eager loading для связанных данных)
- Сжатие ответов (gzip)

### 10. Безопасность
- Публичные endpoint'ы не требуют аутентификации
- Фильтрация только активных ресторанов
- Фильтрация только доступных данных

