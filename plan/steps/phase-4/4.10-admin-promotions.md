# Шаг 4.10: Акции

## Описание
Интерфейс для управления промо-событиями ресторана (акции, тематические вечера, новинки).

## Задачи

### 1. Страница управления промо-событиями

#### 1.1. Компонент PromotionsPage
**Маршрут:** `/promotions` (защищенный)

**Структура:**
- Заголовок: "Акции и события"
- Панель фильтров:
  - Селектор типа промо-события
  - Фильтр по активности
  - Период (dateFrom, dateTo)
  - Фильтр "Текущие" (isCurrent)
- Кнопка "Создать акцию"
- Список промо-событий (grid или таблица)
- Таб "Календарь" (опционально)

#### 1.2. Список промо-событий
**Отображение:**
- Grid layout (карточки)
- Для каждого события:
  - Изображение через компонент `ImagePreview` с `imageId={promotion.imageId}`
  - Заголовок
  - Тип (badge)
  - Период (дата начала - дата окончания)
  - Статус (активно/неактивно)
  - Кнопки: "Редактировать", "Удалить"

**Логика загрузки:**
- GET запрос на `/admin-api/r/:id/promotion` с фильтрами

#### 1.3. Форма создания/редактирования
**Модальное окно:** PromotionFormModal

**Поля:**
```typescript
interface PromotionForm {
  title: string;              // required, max 255
  description: string;        // optional, max 10000
  promotionTypeId: number;    // required
  startDate: string;          // required, date
  endDate: string;            // required, date
  imageId: number | null;     // optional
}
```

**Валидация:**
- `title`: обязательное, max 255
- `promotionTypeId`: обязательное
- `startDate`: обязательное, не в прошлом
- `endDate`: обязательное, >= startDate
- `description`: max 10000

**Логика:**
- Загрузка типов промо-событий для селектора
- POST `/admin-api/r/:id/promotion` (создание)
- PUT `/admin-api/r/:id/promotion/:promotionId` (редактирование)

#### 1.3.1. Загрузка изображений для акций
**Компонент:** `ImageUpload` (общий компонент, см. раздел 6.2 в шаге 4.1)

**Использование:**
```typescript
<ImageUpload
  currentImageId={formData.imageId}
  onImageUploaded={(imageId) => setFormData({ ...formData, imageId })}
  onImageRemoved={() => setFormData({ ...formData, imageId: null })}
  type="promotion"
  recommendedSize="1200x600px - 1920x1080px"
  maxSize={5 * 1024 * 1024} // 5MB
/>
```

#### 1.4. Календарь событий (опционально)
**Компонент:** PromotionsCalendar

**Библиотека:** react-big-calendar или fullcalendar

**Функциональность:**
- Отображение событий на календаре
- Фильтрация по типу
- Клик на событие → открыть детальную информацию или форму редактирования

### 2. Интеграция с API
- `GET /admin-api/r/:id/promotion` - список
- `POST /admin-api/r/:id/promotion` - создание
- `GET /admin-api/r/:id/promotion/:promotionId` - получение
- `PUT /admin-api/r/:id/promotion/:promotionId` - обновление
- `DELETE /admin-api/r/:id/promotion/:promotionId` - удаление
- `GET /admin-api/promotion-types` - список типов (если есть отдельный endpoint)

## Результаты выполнения шага

По итогу выполнения этого шага должны быть созданы следующие артефакты и выполнены следующие проверки:

### Созданные компоненты:
1. ✅ Страница промо-событий:
   - Список промо-событий с фильтрацией
   - Форма создания/редактирования
   - Загрузка изображений

2. ✅ Интеграция с API:
   - Запросы к `/admin-api/r/:id/promotion`
   - Запросы к `/admin-api/image` для загрузки изображений
   - Обработка ответов
   - Обработка ошибок

### Функциональные проверки:
1. ✅ CRUD операции работают:
   - Создание промо-события
   - Редактирование промо-события
   - Удаление промо-события

2. ✅ Загрузка изображений работает:
   - Изображения загружаются через `/admin-api/image`
   - Компонент `ImagePreview` отображает превью корректно
   - При клике на превью открывается модальное окно с оригинальным изображением

### Критерии готовности:
- ✅ Все компоненты созданы и работают
- ✅ Интеграция с API работает
- ✅ Валидация работает
- ✅ Загрузка изображений работает
- ✅ Все функциональные проверки пройдены успешно

**Шаг считается выполненным**, когда все компоненты работают и все функциональные проверки пройдены успешно.

